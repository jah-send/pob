<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>POB-EYE2 Library: flash.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>flash.h File Reference</h1>Flash memory functions. <a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Flash result codes.</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#364994358552439f796b89d6dbba2d7c">FLASH_SUCCESS</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#72f85c67e14f3e6a251d491aa1dd50ac">FLASH_INVALID_COMMAND</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#e03dfde315c66cf377d75cc497773d60">FLASH_SRC_ADDR_ERROR</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#6662a578764e03a3c427ac11cbeb6315">FLASH_DST_ADDR_ERROR</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#0f26f809a88a2d76f633f81677c44648">FLASH_SRC_ADDR_NOT_MAPPED</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#22f2562aa88e505df1a26e91afcdcedb">FLASH_DST_ADDR_NOT_MAPPED</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#4a7124f5c423b345ceb8b5d03bf2f635">FLASH_COUNT_ERROR</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#90cce6a00c83a266ef8ca432f1ead1cd">FLASH_INVALID_SECTOR</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#11091c6397408fe4f9787eea53b0531a">FLASH_SECTOR_NOT_BLANK</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#5d6151d408ffa03c8f14f45cc6a08188">FLASH_SECTOR_NOT_PREPARED_FOR_WRITE_OPERATION</a>&nbsp;&nbsp;&nbsp;9</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#61bc19a6a8051551d21553a0e03e85a9">FLASH_BUSY</a>&nbsp;&nbsp;&nbsp;11</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#ae24153beabe70cd78831db27782a339">FlashInit</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Init flash function.  <a href="#ae24153beabe70cd78831db27782a339"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UInt32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#55400469417323520b244c1a9fda6a41">FlashErase</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Erase flash sector.  <a href="#55400469417323520b244c1a9fda6a41"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UInt32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#58864681e8723cb92cb16885699a5305">FlashWrite</a> (UInt32 sector, UInt8 *buffer, UInt32 bufferSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a buffer into flash.  <a href="#58864681e8723cb92cb16885699a5305"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash_8h.html#d1bcec16c4c88dfb4d708d0057e488d3">FlashRead</a> (UInt32 offset, UInt8 *data, UInt32 len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from flash.  <a href="#d1bcec16c4c88dfb4d708d0057e488d3"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Flash memory functions. 
<p>
<a class="anchor" name="flash"></a><p>
You can write and read 8K bytes of pobeye2 flash. The flash is divided into 15 sectors of 512 bytes. Only the write function must have a sector, the read function can read from anywhere.<p>
<dl class="user" compact><dt><b>flash example</b></dt><dd></dd></dl>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="pob-eye_8h.html">pob-eye.h</a>&gt;</span>

<span class="preprocessor"> #define DATA   "pob-technology"</span>
<span class="preprocessor"></span>
 <span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
 {
        <a class="code" href="pob-eye_8h.html#0d35adb56185f81b48a3091f60862419">UInt8</a> buffer[32];
        <a class="code" href="pob-eye_8h.html#a542033556769a56f3e0b9488048d31d">UInt32</a> size,i;

        <span class="comment">// Init pobeye2 hardware:</span>
        <a class="code" href="pob-eye_8h.html#ea1500b47046a9ded4ef1588d0c9f5f2">InitPobeye2</a>();
        <a class="code" href="uart_8h.html#93cbc1428f9379fca79558ff9b7b38a6">InitUART0</a>(115200);
        <a class="code" href="flash_8h.html#ae24153beabe70cd78831db27782a339">FlashInit</a>();

        <span class="comment">// Get size of DATA:</span>
        size = strlen(DATA);
        <span class="comment">// Copy DATA to buffer:</span>
        memcpy(buffer, DATA, size);

        <span class="comment">// Before write any data, erase flash:</span>
        <a class="code" href="flash_8h.html#55400469417323520b244c1a9fda6a41">FlashErase</a>();

        <span class="comment">// Write buffer to the flash sector 0:</span>
        <a class="code" href="flash_8h.html#58864681e8723cb92cb16885699a5305">FlashWrite</a>(0,buffer,size);
        buffer[0] = 0;

        <span class="comment">// Read 10 bytes from offset 4 in flash data.</span>
        <a class="code" href="flash_8h.html#d1bcec16c4c88dfb4d708d0057e488d3">FlashRead</a>(4,buffer,10);

        <span class="keywordflow">for</span>(i=0;i&lt;10;i++)
        {
          <a class="code" href="uart_8h.html#617d947bc1f957535e78aed5bb43428d">SendByteToUART0</a>(buffer[i]);
        }

        <span class="keywordflow">return</span> 0;
 }
</pre></div> <hr><h2>Define Documentation</h2>
<a class="anchor" name="61bc19a6a8051551d21553a0e03e85a9"></a><!-- doxytag: member="flash.h::FLASH_BUSY" ref="61bc19a6a8051551d21553a0e03e85a9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_BUSY&nbsp;&nbsp;&nbsp;11          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Flash hardware interface busy. 
</div>
</div><p>
<a class="anchor" name="4a7124f5c423b345ceb8b5d03bf2f635"></a><!-- doxytag: member="flash.h::FLASH_COUNT_ERROR" ref="4a7124f5c423b345ceb8b5d03bf2f635" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_COUNT_ERROR&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Byte count is not multiple of 4. 
</div>
</div><p>
<a class="anchor" name="6662a578764e03a3c427ac11cbeb6315"></a><!-- doxytag: member="flash.h::FLASH_DST_ADDR_ERROR" ref="6662a578764e03a3c427ac11cbeb6315" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_DST_ADDR_ERROR&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destination address is not on a correct boundary. 
</div>
</div><p>
<a class="anchor" name="22f2562aa88e505df1a26e91afcdcedb"></a><!-- doxytag: member="flash.h::FLASH_DST_ADDR_NOT_MAPPED" ref="22f2562aa88e505df1a26e91afcdcedb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_DST_ADDR_NOT_MAPPED&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destination address is not mapped in memory. 
</div>
</div><p>
<a class="anchor" name="72f85c67e14f3e6a251d491aa1dd50ac"></a><!-- doxytag: member="flash.h::FLASH_INVALID_COMMAND" ref="72f85c67e14f3e6a251d491aa1dd50ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_INVALID_COMMAND&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Invalid command. 
</div>
</div><p>
<a class="anchor" name="90cce6a00c83a266ef8ca432f1ead1cd"></a><!-- doxytag: member="flash.h::FLASH_INVALID_SECTOR" ref="90cce6a00c83a266ef8ca432f1ead1cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_INVALID_SECTOR&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sector number is invalid. 
</div>
</div><p>
<a class="anchor" name="11091c6397408fe4f9787eea53b0531a"></a><!-- doxytag: member="flash.h::FLASH_SECTOR_NOT_BLANK" ref="11091c6397408fe4f9787eea53b0531a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_SECTOR_NOT_BLANK&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sector is not blank. 
</div>
</div><p>
<a class="anchor" name="5d6151d408ffa03c8f14f45cc6a08188"></a><!-- doxytag: member="flash.h::FLASH_SECTOR_NOT_PREPARED_FOR_WRITE_OPERATION" ref="5d6151d408ffa03c8f14f45cc6a08188" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_SECTOR_NOT_PREPARED_FOR_WRITE_OPERATION&nbsp;&nbsp;&nbsp;9          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sector not prepared for write. 
</div>
</div><p>
<a class="anchor" name="e03dfde315c66cf377d75cc497773d60"></a><!-- doxytag: member="flash.h::FLASH_SRC_ADDR_ERROR" ref="e03dfde315c66cf377d75cc497773d60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_SRC_ADDR_ERROR&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Source address is not on word boundary. 
</div>
</div><p>
<a class="anchor" name="0f26f809a88a2d76f633f81677c44648"></a><!-- doxytag: member="flash.h::FLASH_SRC_ADDR_NOT_MAPPED" ref="0f26f809a88a2d76f633f81677c44648" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_SRC_ADDR_NOT_MAPPED&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Source address is not mapped in memory. 
</div>
</div><p>
<a class="anchor" name="364994358552439f796b89d6dbba2d7c"></a><!-- doxytag: member="flash.h::FLASH_SUCCESS" ref="364994358552439f796b89d6dbba2d7c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_SUCCESS&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Last operation in flash is a success. 
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="55400469417323520b244c1a9fda6a41"></a><!-- doxytag: member="flash.h::FlashErase" ref="55400469417323520b244c1a9fda6a41" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UInt32 FlashErase           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Erase flash sector. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if no error, else error code. </dd></dl>

</div>
</div><p>
<a class="anchor" name="ae24153beabe70cd78831db27782a339"></a><!-- doxytag: member="flash.h::FlashInit" ref="ae24153beabe70cd78831db27782a339" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlashInit           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Init flash function. 
<p>

</div>
</div><p>
<a class="anchor" name="d1bcec16c4c88dfb4d708d0057e488d3"></a><!-- doxytag: member="flash.h::FlashRead" ref="d1bcec16c4c88dfb4d708d0057e488d3" args="(UInt32 offset, UInt8 *data, UInt32 len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlashRead           </td>
          <td>(</td>
          <td class="paramtype">UInt32&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UInt8 *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UInt32&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read data from flash. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>Offset where read data into flash. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Pointer to an array where store the bytes read. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Number of bytes to read. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="58864681e8723cb92cb16885699a5305"></a><!-- doxytag: member="flash.h::FlashWrite" ref="58864681e8723cb92cb16885699a5305" args="(UInt32 sector, UInt8 *buffer, UInt32 bufferSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UInt32 FlashWrite           </td>
          <td>(</td>
          <td class="paramtype">UInt32&nbsp;</td>
          <td class="paramname"> <em>sector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UInt8 *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UInt32&nbsp;</td>
          <td class="paramname"> <em>bufferSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write a buffer into flash. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sector</em>&nbsp;</td><td>Sector number (between 0 and 15). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>Pointer to a buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufferSize</em>&nbsp;</td><td>Number of bytes to write to flash. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if no error, else error code. </dd></dl>

</div>
</div><p>
<!-- 
	Author : Baptiste Burles. POB-Technology
	Date : 10/10/2005
	
	This is the html footer for the Doxygen doc.
	
-->
<html>

<p>

<center>
	<hr size="1"><address style="align: right;"><small>Generated by&nbsp;
	<a href="http://www.doxygen.org/index.html">
	<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
	
	
	<address style="align: right;"><small>
	This is a documentation from 
	<a href="http://www.pob-technology.com">
	<img src="LOGO_POB.JPG" align="middle" border="0"></a> All rights reserved.
	</small></address>
	
</center>

</html>
